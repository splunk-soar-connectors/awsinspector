[comment]: # "Auto-generated SOAR connector documentation"
# AWS Inspector

Publisher: Splunk  
Connector Version: 2\.2\.9  
Product Vendor: AWS  
Product Name: Inspector  
Product Version Supported (regex): "\.\*"  
Minimum Product Version: 5\.0\.0  

This app integrates with AWS Inspector to perform security assessment actions

[comment]: # " File: readme.md"
[comment]: # "  Copyright (c) 2019-2021 Splunk Inc."
[comment]: # ""
[comment]: # "Licensed under the Apache License, Version 2.0 (the 'License');"
[comment]: # "you may not use this file except in compliance with the License."
[comment]: # "You may obtain a copy of the License at"
[comment]: # ""
[comment]: # "    http://www.apache.org/licenses/LICENSE-2.0"
[comment]: # ""
[comment]: # "Unless required by applicable law or agreed to in writing, software distributed under"
[comment]: # "the License is distributed on an 'AS IS' BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND,"
[comment]: # "either express or implied. See the License for the specific language governing permissions"
[comment]: # "and limitations under the License."
[comment]: # ""
## Asset Configuration

There are two ways to configure an AWS Inspector asset. The first is to configure the **access_key**
, **secret_key** and **region** variables. If it is preferred to use a role and Phantom is running
as an EC2 instance, the **use_role** checkbox can be checked instead. This will allow the role that
is attached to the instance to be used. Please see the [AWS EC2 and IAM
documentation](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/iam-roles-for-amazon-ec2.html)
for more information.

## Assumed Role Credentials

The optional **credentials** action parameter consists of temporary **assumed role** credentials
that will be used to perform the action instead of those that are configured in the **asset** . The
parameter is not designed to be configured manually, but should instead be used in conjunction with
the Phantom AWS Security Token Service app. The output of the **assume_role** action of the STS app
with data path **assume_role\_\<number>:action_result.data.\*.Credentials** consists of a dictionary
containing the **AccessKeyId** , **SecretAccessKey** , **SessionToken** and **Expiration** key/value
pairs. This dictionary can be passed directly into the credentials parameter in any of the following
actions within a playbook. For more information, please see the [AWS Identity and Access Management
documentation](https://docs.aws.amazon.com/iam/index.html) .


### Configuration Variables
The below configuration variables are required for this Connector to operate.  These variables are specified when configuring a Inspector asset in SOAR.

VARIABLE | REQUIRED | TYPE | DESCRIPTION
-------- | -------- | ---- | -----------
**access\_key** |  optional  | password | Access Key
**secret\_key** |  optional  | password | Secret Key
**region** |  required  | string | Default Region
**use\_role** |  optional  | boolean | Use attached role when running Phantom in EC2

### Supported Actions  
[test connectivity](#action-test-connectivity) - Validate the asset configuration for connectivity using supplied configuration  
[add target](#action-add-target) - Create a new assessment target using the ARN of the resource group  
[delete target](#action-delete-target) - Delete the assessment target  
[list templates](#action-list-templates) - List the assessment templates of assessment targets  
[list targets](#action-list-targets) - List the assessment target ARNs within the AWS account  
[run assessment](#action-run-assessment) - Start the assessment run specified by the assessment template ARN  
[get findings](#action-get-findings) - List and describe the findings generated by the assessment runs  

## action: 'test connectivity'
Validate the asset configuration for connectivity using supplied configuration

Type: **test**  
Read only: **True**

#### Action Parameters
No parameters are required for this action

#### Action Output
No Output  

## action: 'add target'
Create a new assessment target using the ARN of the resource group

Type: **generic**  
Read only: **False**

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**target\_name** |  required  | Name of the target | string |  `aws inspector target name` 
**resource\_group\_arn** |  optional  | Resource Group ARN used for creating the assessment target | string |  `aws inspector resource group arn`  `aws arn` 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.resource\_group\_arn | string |  `aws inspector resource group arn`  `aws arn` 
action\_result\.parameter\.target\_name | string |  `aws inspector target name` 
action\_result\.data\.\*\.assessmentTargetArn | string |  `aws inspector target arn`  `aws arn` 
action\_result\.summary\.total\_target\_arn | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials`   

## action: 'delete target'
Delete the assessment target

Type: **generic**  
Read only: **False**

Deleting an assessment target will also delete corresponding templates, runs, and findings\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**target\_arn** |  required  | ARN of the assessment target | string |  `aws inspector target arn`  `aws arn` 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.target\_arn | string |  `aws inspector target arn`  `aws arn` 
action\_result\.data | string | 
action\_result\.summary | string | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials`   

## action: 'list templates'
List the assessment templates of assessment targets

Type: **investigate**  
Read only: **True**

In the parameter <b>template\_name</b>, the user can specify an explicit value or a string that contains a wildcard to match the value of the assessment template name\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**target\_arns** |  optional  | List of target ARNs | string |  `aws inspector target arn`  `aws arn` 
**template\_name** |  optional  | Assessment template name pattern | string | 
**limit** |  optional  | Maximum number of templates to be fetched | numeric | 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.limit | numeric | 
action\_result\.parameter\.target\_arns | string |  `aws inspector target arn`  `aws arn` 
action\_result\.parameter\.template\_name | string | 
action\_result\.data\.\*\.arn | string | 
action\_result\.data\.\*\.assessmentRunCount | numeric | 
action\_result\.data\.\*\.assessmentTargetArn | string |  `aws inspector target arn`  `aws arn` 
action\_result\.data\.\*\.createdAt | string | 
action\_result\.data\.\*\.durationInSeconds | numeric | 
action\_result\.data\.\*\.name | string | 
action\_result\.data\.\*\.rulesPackageArns | string | 
action\_result\.summary\.total\_templates | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials`   

## action: 'list targets'
List the assessment target ARNs within the AWS account

Type: **investigate**  
Read only: **True**

In the parameter target\_name, the user can specify an explicit value or a string that contains a wildcard to match the value of the assessment target name\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**target\_name** |  optional  | Assessment target name pattern | string |  `aws inspector target name` 
**limit** |  optional  | Maximum number of targets to be fetched | numeric | 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.limit | numeric | 
action\_result\.parameter\.target\_name | string |  `aws inspector target name` 
action\_result\.data\.\*\.createdAt | string | 
action\_result\.data\.\*\.name | string |  `aws inspector target name` 
action\_result\.data\.\*\.arn | string |  `aws inspector target arn`  `aws arn` 
action\_result\.data\.\*\.updatedAt | string | 
action\_result\.summary\.total\_targets | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials`   

## action: 'run assessment'
Start the assessment run specified by the assessment template ARN

Type: **generic**  
Read only: **False**

While an assessment run is in the COLLECTING\_DATA state then, all other assessment runs will fail\.

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**template\_arn** |  required  | Assessment template ARN to start the assessment run of | string |  `aws inspector template arn`  `aws arn` 
**assessment\_run\_name** |  optional  | Name of the assessment run | string | 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.assessment\_run\_name | string | 
action\_result\.parameter\.template\_arn | string |  `aws inspector template arn`  `aws arn` 
action\_result\.data\.\*\.arn | string |  `aws inspector assessment run arn`  `aws arn` 
action\_result\.data\.\*\.assessmentTemplateArn | string |  `aws inspector template arn`  `aws arn` 
action\_result\.data\.\*\.createdAt | string | 
action\_result\.data\.\*\.dataCollected | boolean | 
action\_result\.data\.\*\.durationInSeconds | numeric | 
action\_result\.data\.\*\.name | string | 
action\_result\.data\.\*\.rulesPackageArns | string | 
action\_result\.data\.\*\.startedAt | string | 
action\_result\.data\.\*\.state | string | 
action\_result\.data\.\*\.stateChangedAt | string | 
action\_result\.data\.\*\.stateChanges\.\*\.state | string | 
action\_result\.data\.\*\.stateChanges\.\*\.stateChangedAt | string | 
action\_result\.summary\.assessment\_run\_arn | numeric |  `aws inspector assessment run arn`  `aws arn` 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials`   

## action: 'get findings'
List and describe the findings generated by the assessment runs

Type: **investigate**  
Read only: **True**

#### Action Parameters
PARAMETER | REQUIRED | DESCRIPTION | TYPE | CONTAINS
--------- | -------- | ----------- | ---- | --------
**assessment\_run\_arns** |  optional  | List of the assessment runs ARNs \(Max Limit\: 50\) | string |  `aws inspector assessment run arn`  `aws arn` 
**severities** |  optional  | List of severity values \(case\-sensitive\) \(Max Limit\: 50\) | string | 
**limit** |  optional  | Maximum number of findings to be fetched | numeric | 
**credentials** |  optional  | Assumed role credentials | string |  `aws credentials` 

#### Action Output
DATA PATH | TYPE | CONTAINS
--------- | ---- | --------
action\_result\.status | string | 
action\_result\.parameter\.assessment\_run\_arns | string |  `aws inspector assessment run arn`  `aws arn` 
action\_result\.parameter\.limit | numeric | 
action\_result\.parameter\.severities | string | 
action\_result\.data\.\*\.arn | string | 
action\_result\.data\.\*\.assetAttributes\.agentId | string |  `aws ec2 instance id` 
action\_result\.data\.\*\.assetAttributes\.amiId | string | 
action\_result\.data\.\*\.assetAttributes\.hostname | string |  `host name` 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.networkInterfaceId | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.privateDnsName | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.privateIpAddress | string |  `ip` 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.privateIpAddresses\.\*\.privateDnsName | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.privateIpAddresses\.\*\.privateIpAddress | string |  `ip` 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.publicDnsName | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.publicIp | string |  `ip` 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.securityGroups\.\*\.groupId | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.securityGroups\.\*\.groupName | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.subnetId | string | 
action\_result\.data\.\*\.assetAttributes\.networkInterfaces\.\*\.vpcId | string |  `aws ec2 vpc id` 
action\_result\.data\.\*\.assetAttributes\.schemaVersion | numeric | 
action\_result\.data\.\*\.assetAttributes\.tags\.\*\.key | string | 
action\_result\.data\.\*\.assetAttributes\.tags\.\*\.value | string |  `email` 
action\_result\.data\.\*\.assetType | string | 
action\_result\.data\.\*\.attributes\.\*\.key | string | 
action\_result\.data\.\*\.attributes\.\*\.value | string | 
action\_result\.data\.\*\.confidence | numeric | 
action\_result\.data\.\*\.createdAt | string | 
action\_result\.data\.\*\.description | string | 
action\_result\.data\.\*\.id | string | 
action\_result\.data\.\*\.indicatorOfCompromise | boolean | 
action\_result\.data\.\*\.numericSeverity | numeric | 
action\_result\.data\.\*\.recommendation | string | 
action\_result\.data\.\*\.schemaVersion | numeric | 
action\_result\.data\.\*\.service | string | 
action\_result\.data\.\*\.serviceAttributes\.assessmentRunArn | string | 
action\_result\.data\.\*\.serviceAttributes\.rulesPackageArn | string | 
action\_result\.data\.\*\.serviceAttributes\.schemaVersion | numeric | 
action\_result\.data\.\*\.severity | string | 
action\_result\.data\.\*\.title | string | 
action\_result\.data\.\*\.updatedAt | string | 
action\_result\.summary\.total\_findings | numeric | 
action\_result\.summary\.total\_templates | numeric | 
action\_result\.message | string | 
summary\.total\_objects | numeric | 
summary\.total\_objects\_successful | numeric | 
action\_result\.parameter\.credentials | string |  `aws credentials` 