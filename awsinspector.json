{
    "appid": "260fc783-af81-433e-95fc-d33664422d6a",
    "name": "AWS Inspector",
    "description": "This app integrates with AWS Inspector to perform various investigative actions",
    "type": "devops",
    "product_vendor": "AWS",
    "logo": "logo_awsinspector.svg",
    "logo_dark": "logo_awsinspector_dark.svg",
    "product_name": "Inspector",
    "product_version_regex": ".*",
    "publisher": "Splunk",
    "license": "Copyright (c) 2019 Splunk Inc.",
    "app_version": "1.0.0",
    "utctime_updated": "2019-05-21T09:29:18.681435Z",
    "package_name": "phantom_awsinspector",
    "main_module": "awsinspector_connector.pyc",
    "min_phantom_version": "4.0.1068",
    "app_wizard_version": "1.0.0",
    "pip_dependencies": {
        "wheel": [
            {
                "module": "boto3",
                "input_file": "wheels/boto3-1.9.96-py2.py3-none-any.whl"
            },
            {
                "module": "botocore",
                "input_file": "wheels/botocore-1.12.96-py2.py3-none-any.whl"
            },
            {
                "module": "s3transfer",
                "input_file": "wheels/s3transfer-0.2.0-py2.py3-none-any.whl"
            },
            {
                "module": "futures",
                "input_file": "wheels/futures-3.2.0-py2-none-any.whl"
            },
            {
                "module": "docutils",
                "input_file": "wheels/docutils-0.14-py2-none-any.whl"
            },
            {
                "module": "jmespath",
                "input_file": "wheels/jmespath-0.9.3-py2.py3-none-any.whl"
            }
        ]
    },
    "configuration": {
        "access_key": {
            "description": "AWS Access Key",
            "data_type": "password",
            "required": true,
            "order": 0
        },
        "secret_key": {
            "description": "AWS Secret Key",
            "data_type": "password",
            "required": true,
            "order": 1
        },
        "region": {
            "description": "AWS Region",
            "data_type": "string",
            "required": true,
            "value_list": [
                "us-east-1",
                "us-east-2",
                "us-west-2",
                "ap-south-1",
                "ap-northeast-1",
                "ap-northeast-2",
                "ap-southeast-1",
                "ap-southeast-2",
                "eu-central-1",
                "eu-west-1",
                "eu-west-2"
            ],
            "order": 2
        }
    },
    "actions": [
        {
            "action": "test connectivity",
            "identifier": "test_connectivity",
            "description": "Validate the asset configuration for connectivity using supplied configuration",
            "verbose": "",
            "type": "test",
            "read_only": true,
            "parameters": {},
            "output": [],
            "versions": "EQ(*)"
        },
        {
            "action": "add target",
            "identifier": "add_target",
            "description": "Creates a new assessment target using the ARN of the resource group",
            "verbose": "",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "target_name": {
                    "description": "Name of target",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "aws inspector target name"
                    ],
                    "value_list": [],
                    "default": "",
                    "order": 0
                },
                "resource_group_arn": {
                    "description": "The ARN that specifies the resource group that is used to create the assessment target",
                    "data_type": "string",
                    "required": false,
                    "primary": false,
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 3,
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.parameter.resource_group_arn",
                    "data_type": "string",
                    "column_name": "Resource Group ARN",
                    "column_order": 2,
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:resourcegroup/0-He7VMMwP"
                    ]
                },
                {
                    "data_path": "action_result.parameter.target_name",
                    "data_type": "string",
                    "column_name": "Target Name",
                    "column_order": 0,
                    "contains": [
                        "aws inspector target name"
                    ],
                    "example_values": [
                        "test_target"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTargetArn",
                    "data_type": "string",
                    "column_name": "Target ARN",
                    "column_order": 1,
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-evshZX5K"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_target_arn",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Target is added successfully"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "delete target",
            "identifier": "delete_target",
            "description": "Deletes the assessment target that is specified by the ARN of the assessment",
            "type": "generic",
            "read_only": false,
            "parameters": {
                "target_arn": {
                    "description": "ARN of the assessment target",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "order": 0
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 1,
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.parameter.target_arn",
                    "data_type": "string",
                    "column_name": "Target ARN",
                    "column_order": 0,
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-KstwgEAp"
                    ]
                },
                {
                    "data_path": "action_result.data",
                    "data_type": "string"
                },
                {
                    "data_path": "action_result.summary.total_target_arn",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Target is removed successfully"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list templates",
            "identifier": "list_templates",
            "description": "Lists the assessment templates that correspond to the assessment targets that are specified by the ARNs of the assessment targets",
            "verbose": "",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "description": "Maximum number of templates to be fetched",
                    "data_type": "numeric",
                    "required": false,
                    "primary": false,
                    "order": 0
                },
                "target_arns": {
                    "description": "list of ARNs that specifies the assessment targets whose assessment templates are being fetched",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "order": 1
                },
                "template_name": {
                    "description": "Name of template",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "aws inspector template name"
                    ],
                    "order": 2
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "example_values": [
                        10
                    ]
                },
                {
                    "data_path": "action_result.parameter.target_arns",
                    "data_type": "string",
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-6oqI2Cov"
                    ]
                },
                {
                    "data_path": "action_result.parameter.template_name",
                    "data_type": "string",
                    "contains": [
                        "aws inspector template name"
                    ],
                    "example_values": [
                        "Assessment-Template-Default"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.arn",
                    "data_type": "string",
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-6oqI2Cov/template/0-26yzApF2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.assessmentRunCount",
                    "data_type": "numeric",
                    "example_values": [
                        0
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.assessmentTargetArn",
                    "data_type": "string",
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-6oqI2Cov"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.createdAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-16 17:50:28.198000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.durationInSeconds",
                    "data_type": "numeric",
                    "example_values": [
                        3600
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.name",
                    "data_type": "string",
                    "contains": [
                        "aws inspector template name"
                    ],
                    "example_values": [
                        "Assessment-Template-Default"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTemplates.*.rulesPackageArns",
                    "data_type": "string",
                    "example_values": [
                        "arn:aws:inspector:us-east-1:316112463485:rulespackage/0-R01qwB5Q"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_templates",
                    "data_type": "numeric",
                    "example_values": [
                        2
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total templates: 2"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "title": "Templates",
                "view": "awsinspector_view.display_view"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "list targets",
            "identifier": "list_targets",
            "description": "Lists the ARNs of the assessment targets within AWS account",
            "verbose": "",
            "type": "investigate",
            "read_only": true,
            "parameters": {
                "limit": {
                    "description": "Maximum number of targets to be fetched",
                    "data_type": "numeric",
                    "required": false,
                    "primary": false,
                    "order": 0
                },
                "target_name": {
                    "description": "Name of target",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "aws inspector target name"
                    ],
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "column_name": "Status",
                    "column_order": 4,
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.parameter.limit",
                    "data_type": "numeric",
                    "column_name": "Limit",
                    "column_order": 0,
                    "example_values": [
                        10
                    ]
                },
                {
                    "data_path": "action_result.parameter.target_name",
                    "data_type": "string",
                    "contains": [
                        "aws inspector target name"
                    ],
                    "example_values": [
                        "test_target"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTargets.*.arn",
                    "data_type": "string",
                    "contains": [
                        "aws inspector target arn"
                    ],
                    "column_name": "Target ARN",
                    "column_order": 2,
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-6oqI2Cov"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTargets.*.createdAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-16 17:50:28.005000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTargets.*.name",
                    "data_type": "string",
                    "contains": [
                        "aws inspector target name"
                    ],
                    "column_name": "Target Name",
                    "column_order": 1,
                    "example_values": [
                        "Assessment-Target-All-Instances"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentTargets.*.updatedAt",
                    "data_type": "string",
                    "column_name": "Updated At",
                    "column_order": 3,
                    "example_values": [
                        "2019-05-16 17:50:28.005000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_targets",
                    "data_type": "numeric",
                    "example_values": [
                        1,
                        2
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total targets: 1",
                        "Total targets: 2"
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                }
            ],
            "render": {
                "type": "table"
            },
            "versions": "EQ(*)"
        },
        {
            "action": "run assessment",
            "identifier": "run_assessment",
            "description": "Starts the assessment run specified by the ARN of the assessment template",
            "type": "generic",
            "read_only": true,
            "parameters": {
                "template_arn": {
                    "description": "The ARN of the assessment template of the assessment run that you want to start",
                    "data_type": "string",
                    "required": true,
                    "primary": true,
                    "contains": [
                        "aws inspector template arn"
                    ],
                    "order": 0
                },
                "assessment_run_name": {
                    "description": "The name of the assessment run for the assessment template whose ARN is used to start the assessment run",
                    "data_type": "string",
                    "required": false,
                    "primary": true,
                    "contains": [
                        "aws inspector assessment run name"
                    ],
                    "order": 1
                }
            },
            "output": [
                {
                    "data_path": "action_result.status",
                    "data_type": "string",
                    "example_values": [
                        "success"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRunArn",
                    "data_type": "string",
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-evshZX5K/template/0-QRxUrrdI/run/0-yHx5BrQI"
                    ]
                },
                {
                    "data_path": "action_result.message",
                    "data_type": "string",
                    "example_values": [
                        "Total assessment run arn: 1",
                        "Total assessment run arn: 0"
                    ]
                },
                {
                    "data_path": "action_result.parameter.template_arn",
                    "data_type": "string",
                    "column_name": "Template ARN",
                    "column_order": 0,
                    "contains": [
                        "aws inspector template arn"
                    ],
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-evshZX5K/template/0-QRxUrrdI"
                    ]
                },
                {
                    "data_path": "action_result.summary.total_assessment_run_arn",
                    "data_type": "numeric",
                    "example_values": [
                        1,
                        0
                    ]
                },
                {
                    "data_path": "summary.total_objects",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "summary.total_objects_successful",
                    "data_type": "numeric",
                    "example_values": [
                        1
                    ]
                },
                {
                    "data_path": "action_result.parameter.assessment_run_name",
                    "data_type": "string",
                    "column_name": "Assessment Run Name",
                    "column_order": 1,
                    "contains": [
                        "aws inspector assessment run name"
                    ],
                    "example_values": [
                        "test-template/2019-05-29T06:35/Uom2"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.dataCollected",
                    "data_type": "boolean",
                    "example_values": [
                        true,
                        false
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.name",
                    "data_type": "string",
                    "example_values": [
                        "test-template/2019-05-29T09:47/RmfI"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.assessmentTemplateArn",
                    "data_type": "string",
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-evshZX5K/template/0-QRxUrrdI"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.state",
                    "data_type": "string",
                    "column_name": "State",
                    "column_order": 3,
                    "example_values": [
                        "COLLECTING_DATA"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.stateChanges.*.state",
                    "data_type": "string",
                    "example_values": [
                        "CREATED"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.stateChanges.*.stateChangedAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-29 09:47:05.863000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.stateChangedAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-29 09:47:06.687000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.createdAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-29 09:47:05.864000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.rulesPackageArns",
                    "data_type": "string",
                    "column_name": "Rules Package ARN",
                    "column_order": 4,
                    "example_values": [
                        "arn:aws:inspector:us-east-1:316112463485:rulespackage/0-R01qwB5Q"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.startedAt",
                    "data_type": "string",
                    "example_values": [
                        "2019-05-29 09:47:06.687000+00:00"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.arn",
                    "data_type": "string",
                    "column_name": "Assessment Run ARN",
                    "column_order": 2,
                    "example_values": [
                        "arn:aws:inspector:us-east-1:849257271967:target/0-evshZX5K/template/0-QRxUrrdI/run/0-D2egFbHs"
                    ]
                },
                {
                    "data_path": "action_result.data.*.assessmentRuns.*.durationInSeconds",
                    "data_type": "numeric",
                    "example_values": [
                        3600
                    ]
                }
            ],
            "render": {
                "type": "custom",
                "title": "Templates",
                "view": "awsinspector_view.display_view"
            },
            "versions": "EQ(*)"
        }
    ]
}